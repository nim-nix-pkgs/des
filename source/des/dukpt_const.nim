import bin

const ksnCounterMask* = [0xFF.byte, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xE0, 0x00, 0x00]
const ipekMask* = [0xC0.byte, 0xC0, 0xC0, 0xC0, 0x00, 0x00, 0x00, 0x00]

const pinMask*  = [0x00.byte, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF]
const mReqMask* = [0x00.byte, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0x00]
const mRspMask* = [0x00.byte, 0x00, 0x00, 0x00, 0xFF, 0x00, 0x00, 0x00]
const dataMask* = [0x00.byte, 0x00, 0x00, 0x00, 0x00, 0xFF, 0x00, 0x00]

const ksnCounterBits* = 21
const ksnSize* = 10

type
    keyVariant* = enum
        kvData, kvDataSimple, kvPin, kvMacReq, kvMacReply
    dukptKey* = array[16, byte]
    dukptKsn* = array[ksnSize, byte]
    

